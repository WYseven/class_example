<!DOCTYPE html>
<html lang="zh-cn">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title></title>
		<style>
			
		</style>
		<script>

			// 一个节点
			class Node {
				constructor(key){
					this.key = key;
					this.left = null;
					this.right = null;
					this.parent = null;
				}
			}

			function inserNode(node,newNode){
				// 新的node小于之前node，放在左边
				if(newNode.key < node.key){
					if(node.left === null){
						node.left = newNode;
					}else{
						inserNode(node.left,newNode)
					}
				}else{
					if(node.right === null){
						node.right = newNode;
					}else{
						inserNode(node.right,newNode)
					}
				}
				newNode.parent = node;
			}

			function inOrderTraverse(node,callBack){
				if(node !== null){
					inOrderTraverse(node.left,callBack)
					callBack(node.key);
					inOrderTraverse(node.right,callBack)
				}
			}
			function prevOrderTraverse(node,callBack){
				if(node !== null){
					callBack(node.key);
					prevOrderTraverse(node.left,callBack)
					prevOrderTraverse(node.right,callBack)
				}
			}
			function postOrderTraverse(node,callBack){
				if(node !== null){
					postOrderTraverse(node.left,callBack)
					postOrderTraverse(node.right,callBack)
					callBack(node.key);
				}
			}

			function searchNode(node,key){
				if(node === null){
					return false;
				}
				if(node.key > key){
					return searchNode(node.left,key)
				}else if(node.key < key){
					return searchNode(node.right,key)
				}else{
					return true;
				}
			}
			function findMinNode(node){
				if(node === null){
					return null;
				}
				if(node.left){
					return findMinNode(node.left);
				}

				console.log(node);

				return node;
			}

			function removeNode(node,key){
				if(node === null){
					return null
				}
				if(key < node.key){
					node.left = removeNode(node.left,key);
					return node;
				}else if(key > node.key){
					node.right = removeNode(node.right,key);
					return node;
				}else{
					if(node.left === null && node.right === null){ // 没有子节点
						node = null;
						return node;
					}else if(node.left === null){  // 有右边
						node.right.parent = node.parent;
						node = node.right;  // 右边直接替代这个节点
						return node;
					}else if (node.right === null) {// 有左边
				
						node.left.parent = node.parent;
						node = node.left;  // 左边直接替代这个节点
						return node;
					}else {
						// 找到右边最小值
						var minNode = findMinNode(node.right);
						node.key = minNode.key;
						// 把右边最小值删除
						node.right = removeNode(node.right,minNode.key);
						return node;
					}
				}

				return node;
			}

			class BinarySearchTree {
				constructor(){
					this.root = null;
					this.arr = [];
				}
				// 插入节点
				insert(key){
					var newNode = new Node(key);
					//console.log(this.root);
					if(this.root === null){
						this.root = newNode;
					}else{
						inserNode(this.root,newNode);
					}
					//console.log(this.root);
					//console.log(newNode);

					this.arr.push(newNode)
				}
				// 中序遍历
				inOrderTraverse(node,callBack){
					inOrderTraverse(node,callBack)
				}
				// 先序遍历
				prevOrderTraverse(node,callBack){
					prevOrderTraverse(node,callBack)
				}
				// 后序遍历
				postOrderTraverse(node,callBack){
					postOrderTraverse(node,callBack)
				}
				// 搜索最小值
				minNode(node){
					if(node){
						while(node && node.left){
							node = node.left;
						}
						return node.key
					}

					return null;
				}
				// 搜索最大值
				maxNode(node){
					if(node){
						while(node && node.right){
							node = node.right;
						}
						return node.key
					}

					return null;
				}
				// 搜索指定key是否存在
				isNodeExit(node,key){
					return searchNode(node,key)
				}
				// 删除指定节点
				removeNode(node,key){
					this.root = removeNode(node,key)
				}
			}
			var tree = new BinarySearchTree();
			tree.insert(11)
			tree.insert(5)
			tree.insert(19)
			tree.insert(3)
			tree.insert(10)
			tree.insert(6)
			tree.insert(12)

			console.log(tree.removeNode(tree.root,11));
			console.log(tree.root);
			console.log(tree.isNodeExit(tree.root,11));

		</script>
	</head>

	<body>
		
	</body>
</html>